package com.vcontrol.vcontroliot.fragment;

import android.text.TextUtils;
import android.view.View;
import android.widget.AdapterView;
import android.widget.Button;
import android.widget.EditText;
import android.widget.RadioGroup;
import android.widget.Spinner;

import com.vcontrol.vcontroliot.R;
import com.vcontrol.vcontroliot.adapter.SimpleSpinnerAdapter;
import com.vcontrol.vcontroliot.util.ConfigParams;
import com.vcontrol.vcontroliot.util.EventNotifyHelper;
import com.vcontrol.vcontroliot.util.SocketUtil;
import com.vcontrol.vcontroliot.util.UiEventEntry;

/**
 * Created by Vcontrol on 2016/11/23.
 */

public class SQFragment extends BaseFragment implements View.OnClickListener,EventNotifyHelper.NotificationCenterDelegate
{

    private RadioGroup soilModelGroup;
    private RadioGroup soil485Group;

    private EditText waterSoil1EditText;
    private EditText waterSoil2EditText;
    private EditText waterSoil3EditText;
    private EditText waterSoil4EditText;

    private Button waterSoil1Button;
    private Button waterSoil2Button;
    private Button waterSoil3Button;
    private Button waterSoil4Button;

    private Spinner soilType1Spinner;
    private Spinner soilType2Spinner;
    private Spinner soilType3Spinner;

    private String[] waterItems;
    private SimpleSpinnerAdapter waterAdapter;
    @Override
    public int getLayoutView()
    {
        return R.layout.fragment_sensor_sq;
    }

    @Override
    public void onDestroy()
    {
        super.onDestroy();
        EventNotifyHelper.getInstance().removeObserver(this, UiEventEntry.READ_DATA);
    }

    @Override
    public void initComponentViews(View view)
    {
        EventNotifyHelper.getInstance().addObserver(this, UiEventEntry.READ_DATA);
        soilModelGroup = (RadioGroup) view.findViewById(R.id.water_soil_model);
        soil485Group = (RadioGroup) view.findViewById(R.id.water_soil_485);
        waterSoil1EditText = (EditText) view.findViewById(R.id.water_soil_0);
        waterSoil2EditText = (EditText) view.findViewById(R.id.water_soil_1);
        waterSoil3EditText = (EditText) view.findViewById(R.id.water_soil_2);
        waterSoil4EditText = (EditText) view.findViewById(R.id.water_soil_3);

        waterSoil1Button = (Button) view.findViewById(R.id.water_soil_type_button);
        waterSoil2Button = (Button) view.findViewById(R.id.water_soil_type_1_button);
        waterSoil3Button = (Button) view.findViewById(R.id.water_soil_type_2_button);
        waterSoil4Button = (Button) view.findViewById(R.id.water_soil_type_3_button);

        soilType1Spinner = (Spinner) view.findViewById(R.id.water_soil_type_1);
        soilType2Spinner = (Spinner) view.findViewById(R.id.water_soil_type_2);
        soilType3Spinner = (Spinner) view.findViewById(R.id.water_soil_type_3);
    }

    private void initView(final View view)
    {

        soilModelGroup.setOnCheckedChangeListener(new RadioGroup.OnCheckedChangeListener()
        {

            @Override
            public void onCheckedChanged(RadioGroup group, int checkedId)
            {
                View checkView = view.findViewById(checkedId);
                if (!checkView.isPressed())
                {
                    return;
                }
                if (checkedId == R.id.water_soil_model_button)
                {
                    SocketUtil.getSocketUtil().sendContent(ConfigParams.SetMoisture485Type + "1");
                }
                else if (checkedId == R.id.water_soil_model_button2)
                {
                    SocketUtil.getSocketUtil().sendContent(ConfigParams.SetMoisture485Type + "2");
                }
                else if (checkedId == R.id.water_soil_model_button3)
                {
                    SocketUtil.getSocketUtil().sendContent(ConfigParams.SetMoisture485Type + "3");
                }
            }
        });
        soil485Group.setOnCheckedChangeListener(new RadioGroup.OnCheckedChangeListener()
        {

            @Override
            public void onCheckedChanged(RadioGroup group, int checkedId)
            {
                View checkView = view.findViewById(checkedId);
                if (!checkView.isPressed())
                {
                    return;
                }
                if (checkedId == R.id.water_soil_485_button)
                {
                }
                // else if (checkedId == R.id.water_soil_model_button2)
                // {
                // }
                // else if (checkedId == R.id.water_soil_model_button3)
                // {
                // }
            }
        });

        soilType1Spinner.setOnItemSelectedListener(new AdapterView.OnItemSelectedListener()
        {

            @Override
            public void onItemSelected(AdapterView<?> parent, View view, int position, long id)
            {

            }

            @Override
            public void onNothingSelected(AdapterView<?> parent)
            {

            }
        });
        soilType2Spinner.setOnItemSelectedListener(new AdapterView.OnItemSelectedListener()
        {

            @Override
            public void onItemSelected(AdapterView<?> parent, View view, int position, long id)
            {

            }

            @Override
            public void onNothingSelected(AdapterView<?> parent)
            {

            }
        });
        soilType3Spinner.setOnItemSelectedListener(new AdapterView.OnItemSelectedListener()
        {

            @Override
            public void onItemSelected(AdapterView<?> parent, View view, int position, long id)
            {

            }

            @Override
            public void onNothingSelected(AdapterView<?> parent)
            {

            }
        });
    }

    @Override
    public void initData()
    {
        waterItems = getResources().getStringArray(R.array.water_soil_type);
        waterAdapter = new SimpleSpinnerAdapter(getActivity(), R.layout.simple_spinner_item, waterItems);
        soilType1Spinner.setAdapter(waterAdapter);
        soilType2Spinner.setAdapter(waterAdapter);
        soilType3Spinner.setAdapter(waterAdapter);
    }

    @Override
    public void setListener()
    {
        waterSoil1Button.setOnClickListener(this);
        waterSoil2Button.setOnClickListener(this);
        waterSoil3Button.setOnClickListener(this);
        waterSoil4Button.setOnClickListener(this);

    }

    @Override
    public void onClick(View view)
    {
        String waterSoil = "";
        switch (view.getId())
        {
            case R.id.water_soil_type_button:
                waterSoil = waterSoil1EditText.getText().toString().trim();
                break;
            case R.id.water_soil_type_1_button:
                waterSoil = waterSoil2EditText.getText().toString().trim();

                break;
            case R.id.water_soil_type_2_button:
                waterSoil = waterSoil3EditText.getText().toString().trim();

                break;
            case R.id.water_soil_type_3_button:
                waterSoil = waterSoil4EditText.getText().toString().trim();

                break;

            default:
                break;
        }
    }

    @Override
    public void didReceivedNotification(int id, Object... args)
    {
        String result = (String) args[0];
        String content = (String) args[1];
        if (TextUtils.isEmpty(result) || TextUtils.isEmpty(content))
        {
            return;
        }
//        setData(result);
    }
}
